---
title: Configuration
description: Configure Canaveral with canaveral.yaml or canaveral.toml.
---

import { Aside, Tabs, TabItem } from '@astrojs/starlight/components';

# Configuration

Canaveral uses a `canaveral.yaml` or `canaveral.toml` file in your project root for configuration. The `canaveral init` command generates this file with sensible defaults based on your project. If no config file is found, Canaveral uses auto-detected defaults.

## Basic Structure

<Tabs>
  <TabItem label="YAML">
    ```yaml title="canaveral.yaml"
    name: MyApp

    versioning:
      strategy: semver
      tag_format: "v{version}"

    git:
      branch: main
      require_clean: true
      push_tags: true

    changelog:
      enabled: true
      file: CHANGELOG.md

    packages: []

    hooks: {}
    ```
  </TabItem>
  <TabItem label="TOML">
    ```toml title="canaveral.toml"
    name = "MyApp"

    [versioning]
    strategy = "semver"
    tag_format = "v{version}"

    [git]
    branch = "main"
    require_clean = true
    push_tags = true

    [changelog]
    enabled = true
    file = "CHANGELOG.md"
    ```
  </TabItem>
</Tabs>

## Versioning Section

Controls how versions are calculated and formatted.

```yaml
versioning:
  # Version strategy: semver, calver, or build-number
  strategy: semver

  # Tag format template. {version} is replaced with the version string.
  tag_format: "v{version}"

  # Independent versioning per package (monorepo)
  independent: false

  # Prerelease identifier (e.g., "alpha", "beta", "rc")
  prerelease_identifier: ""

  # Build metadata appended to version
  build_metadata: ""
```

### Strategies

- **semver** -- Semantic versioning (major.minor.patch) based on conventional commits. Breaking changes bump major, features bump minor, fixes bump patch.
- **calver** -- Calendar versioning (e.g., 2026.02.1).
- **build-number** -- Simple incrementing build number.

## Git Section

Controls git behavior during releases.

```yaml
git:
  # Remote name
  remote: origin

  # Main branch name
  branch: main

  # Require clean working directory before release
  require_clean: true

  # Push tags after creating them
  push_tags: true

  # Push commits after versioning
  push_commits: true

  # Commit message template. {version} is replaced.
  commit_message: "chore(release): {version}"

  # Sign commits with GPG
  sign_commits: false

  # Sign tags with GPG
  sign_tags: false
```

## Changelog Section

Controls changelog generation from conventional commits.

```yaml
changelog:
  # Enable changelog generation
  enabled: true

  # Output file path
  file: CHANGELOG.md

  # Format: markdown or json
  format: markdown

  # Header text prepended to changelog
  header: "# Changelog"

  # Include commit hashes in output
  include_hashes: true

  # Include commit authors
  include_authors: false

  # Include dates
  include_dates: true

  # Commit type display names (customize section headers)
  types:
    feat: Features
    fix: Bug Fixes
    docs: Documentation
    refactor: Code Refactoring
    perf: Performance
    test: Tests
    chore: Maintenance
```

## Packages Section

Define packages in a monorepo. Each package can have its own adapter and publish configuration.

```yaml
packages:
  - name: my-lib
    path: packages/my-lib
    adapter: npm
    publish: true

  - name: my-cli
    path: crates/my-cli
    adapter: cargo
    publish: true
```

Supported adapters: `npm`, `cargo`, `python`, `go`, `maven`, `docker`.

## Hooks Section

Run scripts at various lifecycle stages. Canaveral supports 8 hook stages:

```yaml
hooks:
  pre_version:
    - "echo 'About to bump version'"
  post_version:
    - "./scripts/update-lock.sh"
  pre_changelog:
    - "echo 'Generating changelog'"
  post_changelog:
    - "./scripts/format-changelog.sh"
  pre_publish:
    - "cargo test"
    - "cargo clippy"
  post_publish:
    - "./scripts/notify-slack.sh"
  pre_git:
    - "echo 'About to commit and tag'"
  post_git:
    - "echo 'Committed and tagged'"
```

## Publish Section

Configure registry publishing behavior.

```yaml
publish:
  # Publish in dependency order for monorepos
  ordered: true

  # Retry failed publishes
  retry: 2

  # Dry run (validate without publishing)
  dry_run: false

  # Registry overrides
  registries:
    npm:
      registry: "https://registry.npmjs.org"
      access: public
    cargo:
      registry: "crates-io"
```

## Signing Section

Configure code signing for builds.

```yaml
signing:
  # Enable code signing
  enabled: true

  # Provider: macos, windows, android, gpg
  provider: macos

  # Signing identity
  identity: "Apple Distribution: My Company (TEAMID)"

  # Verify signatures after signing
  verify_after_sign: true

  # macOS-specific options
  macos:
    keychain: login
    entitlements: MyApp.entitlements

  # Android-specific options
  android:
    keystore_path: "${ANDROID_KEYSTORE_PATH}"
    key_alias: "${ANDROID_KEY_ALIAS}"

  # GPG signing options
  gpg:
    key_id: "ABCDEF1234567890"
```

## Stores Section

Configure app store and registry credentials.

```yaml
stores:
  apple:
    api_key_id: "${APP_STORE_CONNECT_API_KEY_ID}"
    issuer_id: "${APP_STORE_CONNECT_ISSUER_ID}"
    api_key_path: "${APP_STORE_CONNECT_API_KEY_PATH}"
    team_id: "${APP_STORE_CONNECT_TEAM_ID}"

  google_play:
    service_account_key: "${GOOGLE_PLAY_SERVICE_ACCOUNT_KEY}"

  npm:
    token: "${NPM_TOKEN}"
    registry: "https://registry.npmjs.org"

  crates_io:
    token: "${CARGO_REGISTRY_TOKEN}"
```

## Tasks Section

Configure task orchestration for monorepo workflows (the `run` command).

```yaml
tasks:
  # Maximum concurrent tasks
  concurrency: 4

  # Task pipeline definitions
  pipeline:
    build:
      command: "cargo build"
      depends_on_packages: true   # Run in dependency order
      outputs:
        - "target/**"
    test:
      command: "cargo test"
      depends_on:
        - build
    lint:
      command: "cargo clippy"

  # Task caching
  cache:
    enabled: true
```

## CI Section

Configure CI pipeline behavior for the `ci` command.

```yaml
ci:
  # CI platform: github, gitlab
  platform: github

  # CI mode
  mode: standard

  # Tasks to run on pull requests
  on_pr:
    - lint
    - test

  # Tasks to run on push to main
  on_push_main:
    - build
    - test
    - publish

  # Tasks to run on tag push
  on_tag:
    - build
    - publish
    - release
```

## PR Section

Configure pull request validation for the `pr` command.

```yaml
pr:
  # Branching model: trunk, gitflow, github-flow
  branching_model: trunk

  # Checks to run during PR validation
  checks:
    - commit-format
    - version-conflict
    - tests
    - lint

  # Require changelog entry
  require_changelog: false

  # Require conventional commits
  require_conventional_commits: true
```

## Release Notes Section

```yaml
release_notes:
  # Template for release notes
  template: default

  # Include contributor list
  include_contributors: true
```

## Metadata Section

Configure app store metadata management.

```yaml
metadata:
  # Path to metadata directory
  path: metadata

  # Default locale
  default_locale: en-US
```

## Environment Variables

Canaveral reads credentials and configuration from environment variables. Use environment variables for all sensitive values.

<Aside type="tip">
  Always use environment variables for sensitive values like passwords, API keys, and tokens. Never commit credentials to your repository.
</Aside>

### Common Environment Variables

| Variable | Description |
|----------|-------------|
| `APP_STORE_CONNECT_API_KEY_ID` | App Store Connect API key ID |
| `APP_STORE_CONNECT_ISSUER_ID` | App Store Connect issuer ID |
| `APP_STORE_CONNECT_API_KEY` | App Store Connect API key (PEM content or path to .p8 file) |
| `APP_STORE_CONNECT_API_KEY_PATH` | Path to App Store Connect .p8 key file |
| `APP_STORE_CONNECT_TEAM_ID` | App Store Connect team ID (optional) |
| `GOOGLE_PLAY_SERVICE_ACCOUNT_KEY` | Google Play service account JSON (content or path) |
| `GOOGLE_APPLICATION_CREDENTIALS` | Google Cloud credentials file path |
| `FIREBASE_PROJECT_ID` | Firebase project ID |
| `FIREBASE_APP_ID` | Firebase app ID |
| `FIREBASE_TOKEN` | Firebase CLI token |
| `FIREBASE_SERVICE_ACCOUNT` | Firebase service account path |
| `NPM_TOKEN` | npm registry token |
| `CARGO_REGISTRY_TOKEN` | crates.io API token |
| `ANDROID_KEYSTORE_PATH` | Path to Android keystore |
| `ANDROID_KEYSTORE_PASSWORD` | Android keystore password |
| `ANDROID_KEY_ALIAS` | Android signing key alias |
| `ANDROID_KEY_PASSWORD` | Android signing key password |
| `MATCH_PASSWORD` | Encryption password for match certificate storage |
| `MATCH_GIT_URL` | Git URL for match certificate storage |

## Validation

Validate your configuration and repository state:

```bash
canaveral validate
```

Check your environment for required tools:

```bash
canaveral doctor
```
